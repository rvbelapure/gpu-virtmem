<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>kidron-utils-rce: include/packetheader.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>include/packetheader.h</h1><a href="packetheader_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00009"></a>00009 <span class="preprocessor">#ifndef PACKETHEADER_H_</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define PACKETHEADER_H_</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a><a class="code" href="packetheader_8h.html#3ebf7c4fcbf17b618a01df30a79859d3">00012</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="packetheader_8h.html#3ebf7c4fcbf17b618a01df30a79859d3">uint8_t</a>;
<a name="l00013"></a><a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">00013</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">uint16_t</a>;
<a name="l00014"></a><a class="code" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">00014</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a>;
<a name="l00015"></a><a class="code" href="packetheader_8h.html#d4cefa90f6d456c4f107986f647f27ef">00015</a> <span class="keyword">typedef</span> <span class="keywordtype">long</span> <a class="code" href="packetheader_8h.html#d4cefa90f6d456c4f107986f647f27ef">int64_t</a>;
<a name="l00016"></a><a class="code" href="packetheader_8h.html#f754720bc60e6c844bda5b322163dfa9">00016</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="packetheader_8h.html#f754720bc60e6c844bda5b322163dfa9">uint64_t</a>;
<a name="l00017"></a><a class="code" href="packetheader_8h.html#9859cb7926bd0d9912bc0942c657b71f">00017</a> <span class="keyword">typedef</span> <a class="code" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a> <a class="code" href="packetheader_8h.html#9859cb7926bd0d9912bc0942c657b71f">grant_ref_t</a>;
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="comment">// if including from driver, manually define. but ***make sure*** it</span>
<a name="l00020"></a>00020 <span class="comment">// remains consistent with nvidia definition</span>
<a name="l00021"></a>00021 <span class="comment">// Assuming enum is defined as int everywhere</span>
<a name="l00022"></a>00022 <span class="comment">//typedef int cudaError_t;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">// include this file when not compiling from frontend driver</span>
<a name="l00025"></a>00025 <span class="comment">// some crappy make issues due to include dependencies and path messup</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;driver_types.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;vector_types.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="packetheader_8h.html#df4aa8556c0392d549d390e1036a2ed9">00031</a> <span class="keyword">typedef</span> pthread_t <a class="code" href="packetheader_8h.html#df4aa8556c0392d549d390e1036a2ed9">tid_t</a>;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="packetheader_8h.html#d73df97f461eeacacf44ee136256a68b">00034</a> <span class="preprocessor">#define MAX_ARGS 4       // most cuda calls so far</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a>00036 <span class="comment">// Possible flag values</span>
<a name="l00037"></a>00037 <span class="comment">// request - from DomU to Dom0</span>
<a name="l00038"></a>00038 <span class="comment">// response - from Dom0 to DomU</span>
<a name="l00039"></a>00039 <span class="comment">// \todo Possible to define 4 more flags - may correspond to type of error</span>
<a name="l00040"></a><a class="code" href="packetheader_8h.html#f85d533c8279e8494025d7c22ec09edd">00040</a> <span class="preprocessor">#define CUDA_response 0x1</span>
<a name="l00041"></a><a class="code" href="packetheader_8h.html#d0777d402a0589d79c7e91a0319e09e9">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define CUDA_request 0x2</span>
<a name="l00042"></a><a class="code" href="packetheader_8h.html#32f959609216ae972f6f1e83a20733ff">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define CUDA_more_data 0x4</span>
<a name="l00043"></a><a class="code" href="packetheader_8h.html#2fd277ee02562b49c4f2a804bcee920c">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define CUDA_error 0x8</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="comment">// For faster checking for {Memcpy, SetupArgument, Launch, GetDevice props}</span>
<a name="l00046"></a>00046 <span class="comment">// mark the flags value with this. The actual function can then be retrieved</span>
<a name="l00047"></a>00047 <span class="comment">// using the method id</span>
<a name="l00048"></a><a class="code" href="packetheader_8h.html#dc697dd1d247030f403c27c2cbb9295a">00048</a> <span class="preprocessor">#define CUDA_Copytype 0x10</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="comment">// Sometimes it may not be required from the backend that it map the pages being</span>
<a name="l00051"></a>00051 <span class="comment">// passed because they have already been mapped at handshake time</span>
<a name="l00052"></a>00052 <span class="comment">// Since ret_ex_val in cuda_packet_t is the only field in the packet which is</span>
<a name="l00053"></a>00053 <span class="comment">// not interpreted at the time of frontend calling backend,</span>
<a name="l00054"></a>00054 <span class="comment">// using this field to indicate to the backend whether it should</span>
<a name="l00055"></a>00055 <span class="comment">// bother calling xc_map_foreign_range or not.</span>
<a name="l00056"></a>00056 <span class="comment">// And this needs to be looked at only in cases of those calls which require</span>
<a name="l00057"></a>00057 <span class="comment">// a buffer passing</span>
<a name="l00058"></a>00058 <span class="comment">// Therefore, if this position in flag is set, it would mean address is already</span>
<a name="l00059"></a>00059 <span class="comment">// mapped else mapping needs to be done</span>
<a name="l00060"></a><a class="code" href="packetheader_8h.html#89da331bd85dfb62287c840c169520a4">00060</a> <span class="preprocessor">#define CUDA_Addrmapped 0x20</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a>00062 <span class="comment">// Indicate whether this buffer was allocated with cudaMallocHost or usual</span>
<a name="l00063"></a>00063 <span class="comment">// malloc. If former, then no copying of buffer is required for the calls that</span>
<a name="l00064"></a>00064 <span class="comment">// need to use this</span>
<a name="l00065"></a><a class="code" href="packetheader_8h.html#c92c856c26bc2737f1122e3c6554aa14">00065</a> <span class="preprocessor">#define CUDA_Addrshared 0x40</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a>00067 <span class="comment">// Values within the driver to indicate whether mapping of buffer was done or not</span>
<a name="l00068"></a><a class="code" href="packetheader_8h.html#ec34451764dbf51b4630f54707632ec0">00068</a> <span class="preprocessor">#define ADDR_ALREADY_MAPPED 0x1</span>
<a name="l00069"></a><a class="code" href="packetheader_8h.html#93d7e108939322d4fe97b7aca1034e84">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define ADDR_UNMAPPED 0x2</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a>00071 <span class="comment">// Possible data size units. These are used to mark the ret_ex_val field as and</span>
<a name="l00072"></a>00072 <span class="comment">// when needed in calls from frontend to backend. The reason the field is not</span>
<a name="l00073"></a>00073 <span class="comment">// getting used as size itself is that their could be more than one argument</span>
<a name="l00074"></a>00074 <span class="comment">// that needs to specify the size. So leaving size in the args array instead</span>
<a name="l00075"></a>00075 <span class="comment">// of putting in ret_ex_val. Also, the unit will be constant for any number of</span>
<a name="l00076"></a>00076 <span class="comment">// fields that specify data. Therefore use the max granularity possible to avoid</span>
<a name="l00077"></a>00077 <span class="comment">// extra copy and wrong arguments. These units can be used as multiplies to get</span>
<a name="l00078"></a>00078 <span class="comment">// the real size whenever needed. There are multiple granularities to avoid</span>
<a name="l00079"></a>00079 <span class="comment">// extra copying as far as possible</span>
<a name="l00080"></a><a class="code" href="packetheader_8h.html#ed631c2297dc5ee9b66e4d52e6ffd5c9">00080</a> <span class="preprocessor">#define DATA_UNIT_1BYTE 1</span>
<a name="l00081"></a><a class="code" href="packetheader_8h.html#809613fe983cbe0ed91cc7ca58c4c004">00081</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_2BYTE 2</span>
<a name="l00082"></a><a class="code" href="packetheader_8h.html#b4079d9c90b73cb538da59e20dfe7f05">00082</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_3BYTE 3</span>
<a name="l00083"></a><a class="code" href="packetheader_8h.html#e6c060774adfce5f2130d0a26be94720">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_4BYTE 4</span>
<a name="l00084"></a><a class="code" href="packetheader_8h.html#423f4795b4f567e7287197a235a01f1b">00084</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_5BYTE 5</span>
<a name="l00085"></a><a class="code" href="packetheader_8h.html#0afcf48cde6b213595fd101eaeecda15">00085</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_6BYTE 6</span>
<a name="l00086"></a><a class="code" href="packetheader_8h.html#8bcdfedefca91732dad5216f1ce9b37c">00086</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_7BYTE 7</span>
<a name="l00087"></a><a class="code" href="packetheader_8h.html#0618392860bfa0bd80c090675c469104">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_8BYTE 8</span>
<a name="l00088"></a><a class="code" href="packetheader_8h.html#4ebe5f10a8753f4a54825ef3ebad4c77">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_PAGES 4096</span>
<a name="l00089"></a><a class="code" href="packetheader_8h.html#c25648b955bd52df28285218a0778d20">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_KB 1024</span>
<a name="l00090"></a><a class="code" href="packetheader_8h.html#ffa01037e43a1c9f8b9e9892594f294a">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_MB (1024 * 1024)</span>
<a name="l00091"></a><a class="code" href="packetheader_8h.html#7699b1f249788dd4509fa2114f1f9c9a">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UNIT_GB (1024 * 1024 * 1024)</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>
<a name="l00093"></a><a class="code" href="packetheader_8h.html#5477ac5e0841a814f1d051df76a5d5e6">00093</a> <span class="preprocessor">#define MAX_SIZE_SIZE 65535   // max number that size var can take</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a><a class="code" href="structtf__arg.html">00095</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structtf__arg.html">tf_arg</a> {
<a name="l00096"></a>00096         <span class="comment">// \todo For now following ring mechanism and using mfns straight</span>
<a name="l00097"></a>00097 <span class="comment">//      grant_ref_t gref;   // Reference to page with data</span>
<a name="l00098"></a><a class="code" href="structtf__arg.html#7dd841d7971b7bdd201869fac0f6e6f6">00098</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="structtf__arg.html#7dd841d7971b7bdd201869fac0f6e6f6">mfn</a>;  <span class="comment">// Granted mfn</span>
<a name="l00099"></a><a class="code" href="structtf__arg.html#742f30abda05ed29accea3d3dcdd6b4d">00099</a>         <a class="code" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a> <a class="code" href="structtf__arg.html#742f30abda05ed29accea3d3dcdd6b4d">ref</a>;       <span class="comment">// need to maintain grant ref for ending foreign access</span>
<a name="l00100"></a><a class="code" href="structtf__arg.html#4a3442cab0fc386667716869de44a0ef">00100</a>         <a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">uint16_t</a> <a class="code" href="structtf__arg.html#4a3442cab0fc386667716869de44a0ef">offset</a>;    <span class="comment">// offset within the page</span>
<a name="l00101"></a>00101         <span class="comment">// This size can be in different units as indicated by the extra info</span>
<a name="l00102"></a>00102         <span class="comment">// and should be interpreted accordingly</span>
<a name="l00103"></a><a class="code" href="structtf__arg.html#977899c6d20cd1f3176bd2bdabe6d43e">00103</a>         <a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">uint16_t</a> <a class="code" href="structtf__arg.html#977899c6d20cd1f3176bd2bdabe6d43e">size</a>;      <span class="comment">// size from offset, if it goes beyond a page,</span>
<a name="l00104"></a>00104                         <span class="comment">// means those pages will also be granted already</span>
<a name="l00105"></a>00105 } <a class="code" href="structtf__arg.html">tf_args_t</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">// The cudaRegisterFunction() has 10 arguments. Instead of passing them in multiple</span>
<a name="l00108"></a>00108 <span class="comment">// packet rounds, it is serialized onto as many pages and can be accessed by</span>
<a name="l00109"></a>00109 <span class="comment">// using this struct</span>
<a name="l00110"></a><a class="code" href="structreg__func__args__t.html">00110</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00111"></a><a class="code" href="structreg__func__args__t.html#9c3a4b377a91f5934c7d008575417895">00111</a>         <span class="keywordtype">void</span>** fatCubinHandle;
<a name="l00112"></a><a class="code" href="structreg__func__args__t.html#9480f6b48ab0d9caf25a27b4369bc34b">00112</a>         <span class="keywordtype">char</span>* hostFun;
<a name="l00113"></a>00113         <span class="comment">// the hostFEaddr is used to keep the local pointer to the hostFun</span>
<a name="l00114"></a>00114         <span class="comment">// this is retrieved when launch is called; this is only the pointer</span>
<a name="l00115"></a>00115         <span class="comment">// not the string</span>
<a name="l00116"></a><a class="code" href="structreg__func__args__t.html#1b82e46c5a98b144a4ab3902f461b1fd">00116</a>         <span class="keywordtype">char</span>* hostFEaddr;  <span class="comment">// original Key in BE to retrieve when launch is called</span>
<a name="l00117"></a><a class="code" href="structreg__func__args__t.html#669d5d08d134510584ffe9b24dce7260">00117</a>     <span class="keywordtype">char</span>* deviceFun;
<a name="l00118"></a><a class="code" href="structreg__func__args__t.html#3e043eade824df3e28f2192eb5f116be">00118</a>         <span class="keywordtype">char</span>* deviceName;
<a name="l00119"></a><a class="code" href="structreg__func__args__t.html#6d7f889d2699ca1530e4e5c8ff8d6d44">00119</a>         <span class="keywordtype">int</span> thread_limit;
<a name="l00120"></a><a class="code" href="structreg__func__args__t.html#28b2a617600812160085cfffdb327bc0">00120</a>         uint3* tid;
<a name="l00121"></a><a class="code" href="structreg__func__args__t.html#72214650aea2a68b0f5f9d38c9a021b5">00121</a>     uint3* bid;
<a name="l00122"></a><a class="code" href="structreg__func__args__t.html#fde64e5bcd234c475c8ec30a84173bc2">00122</a>         dim3* bDim;
<a name="l00123"></a><a class="code" href="structreg__func__args__t.html#de0a7020addf639b26b362c9e9301c41">00123</a>         dim3* gDim;
<a name="l00124"></a><a class="code" href="structreg__func__args__t.html#8188af1e984301afa208419e0496589e">00124</a>         <span class="keywordtype">int</span>* wSize;
<a name="l00125"></a>00125 } <a class="code" href="structreg__func__args__t.html">reg_func_args_t</a>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// The __cudaRegisterVar() has 8 arguments. Pass them in one page</span>
<a name="l00128"></a><a class="code" href="structreg__var__args__t.html">00128</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00129"></a><a class="code" href="structreg__var__args__t.html#ceb65625b359807425237b3d32561dce">00129</a>         <span class="keywordtype">void</span> **fatCubinHandle;
<a name="l00130"></a><a class="code" href="structreg__var__args__t.html#0cdfe453409023a0680f14698206cee8">00130</a>         <span class="keywordtype">char</span> *hostVar;  <span class="comment">// Address coming from Guest thru RegisterVar</span>
<a name="l00131"></a><a class="code" href="structreg__var__args__t.html#2fd84372da8fd4576f261d1b33b59498">00131</a>         <span class="keywordtype">char</span> *dom0HostAddr;  <span class="comment">// This addr will be registered with cuda driver instead</span>
<a name="l00132"></a><a class="code" href="structreg__var__args__t.html#0379f1566c4f4a00404dccdd842886d6">00132</a>         <span class="keywordtype">char</span> *deviceAddress;
<a name="l00133"></a><a class="code" href="structreg__var__args__t.html#b79625f5316b03b27df48d5bd2ec86e3">00133</a>         <span class="keywordtype">char</span> *deviceName;
<a name="l00134"></a><a class="code" href="structreg__var__args__t.html#4ca1d7c26665af4ae814bbf3e8c6b26b">00134</a>         <span class="keywordtype">int</span> ext;
<a name="l00135"></a><a class="code" href="structreg__var__args__t.html#1bd86387354f66199eb597b242623b2a">00135</a>         <span class="keywordtype">int</span> size;
<a name="l00136"></a><a class="code" href="structreg__var__args__t.html#91cf93764f6905c0bca8021188de7f08">00136</a>         <span class="keywordtype">int</span> constant;
<a name="l00137"></a><a class="code" href="structreg__var__args__t.html#807e031b09f43f297b6357240e1eef91">00137</a>         <span class="keywordtype">int</span> global;
<a name="l00138"></a>00138 } <a class="code" href="structreg__var__args__t.html">reg_var_args_t</a>;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140 <span class="comment">// The __cudaRegisterTex() has 8 arguments. Pass them in one page</span>
<a name="l00141"></a><a class="code" href="structreg__tex__args__t.html">00141</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00142"></a><a class="code" href="structreg__tex__args__t.html#2825a9a0aca247dc30997306ea54f39f">00142</a>         <span class="keywordtype">void</span> **fatCubinHandle;
<a name="l00143"></a><a class="code" href="structreg__tex__args__t.html#9dd80a369d138e7820f21f3497c8e72e">00143</a>         <span class="keyword">struct </span>textureReference *hostVar;  <span class="comment">// Address coming from Guest thru RegisterTexture</span>
<a name="l00144"></a><a class="code" href="structreg__tex__args__t.html#f2b0b36351daada84c3e6ad9149d8c5c">00144</a>         <span class="keyword">struct </span>cudaChannelFormatDesc *hostChannel;  <span class="comment">// Note this down as well</span>
<a name="l00145"></a><a class="code" href="structreg__tex__args__t.html#15ae69be22dac70ea738add85dc35ae4">00145</a>         <span class="keyword">struct </span>textureReference *hostFEVar;  <span class="comment">// This addr will be registered with cuda driver instead</span>
<a name="l00146"></a><a class="code" href="structreg__tex__args__t.html#602a2f5aa63f2839373d303f9e08fade">00146</a>         <span class="keywordtype">void</span> **deviceAddress;
<a name="l00147"></a><a class="code" href="structreg__tex__args__t.html#e07ed25f33b61ea7560f9f5a6c6d1ff8">00147</a>         <span class="keywordtype">char</span> *deviceName;
<a name="l00148"></a><a class="code" href="structreg__tex__args__t.html#869b555631bbc3089f30b1b17cb92cfb">00148</a>         <span class="keywordtype">int</span> dim;
<a name="l00149"></a><a class="code" href="structreg__tex__args__t.html#fc03f178333b6d1b859484c42af24550">00149</a>         <span class="keywordtype">int</span> norm;
<a name="l00150"></a><a class="code" href="structreg__tex__args__t.html#3822c672d862a97a31b96bec974a63b9">00150</a>         <span class="keywordtype">int</span> ext;
<a name="l00151"></a>00151 } <a class="code" href="structreg__tex__args__t.html">reg_tex_args_t</a>;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">// Arguments to functions can either be a simple argument or grant reference</span>
<a name="l00154"></a>00154 <span class="comment">// Left to the function to decipher</span>
<a name="l00155"></a>00155 <span class="comment">// Arguments will be filled in the order as in function declaration</span>
<a name="l00156"></a>00156 <span class="comment">// Currently this union has the possible arguments seen in common CUDA calls</span>
<a name="l00157"></a><a class="code" href="unionargs.html">00157</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="unionargs.html">args</a> {
<a name="l00158"></a><a class="code" href="unionargs.html#78cd6ae7b7fadc4f9a1b544b24be9fcb">00158</a>         <span class="keywordtype">int</span> <a class="code" href="unionargs.html#78cd6ae7b7fadc4f9a1b544b24be9fcb">arr_argii</a>[4];
<a name="l00159"></a><a class="code" href="unionargs.html#2ab0adb9dd3a142f00fd0ee8f0988660">00159</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="unionargs.html#2ab0adb9dd3a142f00fd0ee8f0988660">arr_arguii</a>[4];
<a name="l00160"></a><a class="code" href="unionargs.html#de3930a51753a379897c95425357150a">00160</a>         <a class="code" href="packetheader_8h.html#d4cefa90f6d456c4f107986f647f27ef">int64_t</a> <a class="code" href="unionargs.html#de3930a51753a379897c95425357150a">argi</a>;
<a name="l00161"></a><a class="code" href="unionargs.html#e27862ca01c2ff9913eb0d4393a32feb">00161</a>         <a class="code" href="packetheader_8h.html#f754720bc60e6c844bda5b322163dfa9">uint64_t</a> <a class="code" href="unionargs.html#e27862ca01c2ff9913eb0d4393a32feb">argui</a>;
<a name="l00162"></a><a class="code" href="unionargs.html#241b6ff90324e7f74eac2aa13f3aa260">00162</a>         <span class="keywordtype">float</span> <a class="code" href="unionargs.html#241b6ff90324e7f74eac2aa13f3aa260">argf</a>;
<a name="l00163"></a><a class="code" href="unionargs.html#7bd7c2dc865b319f501b2c6e3300a885">00163</a>         <span class="keywordtype">void</span> *<a class="code" href="unionargs.html#7bd7c2dc865b319f501b2c6e3300a885">argp</a>;
<a name="l00164"></a><a class="code" href="unionargs.html#15894ac415e633c96f7e42f48eb8536c">00164</a>         <span class="keywordtype">void</span> **<a class="code" href="unionargs.html#15894ac415e633c96f7e42f48eb8536c">argdp</a>;
<a name="l00165"></a><a class="code" href="unionargs.html#9eae36b08cf2f7a05c8cfd8a1c3fa103">00165</a>         <span class="keywordtype">char</span> *<a class="code" href="unionargs.html#9eae36b08cf2f7a05c8cfd8a1c3fa103">argcp</a>;
<a name="l00166"></a><a class="code" href="unionargs.html#0f2502ac4d9a0df3875c31cdfc50af54">00166</a>         size_t <a class="code" href="unionargs.html#0f2502ac4d9a0df3875c31cdfc50af54">arr_argi</a>[2];  <span class="comment">// to combine multiple args wherever possible to keep total</span>
<a name="l00167"></a>00167                                 <span class="comment">// args restricted to 4</span>
<a name="l00168"></a><a class="code" href="unionargs.html#6bcc037ed07aa7a15579dfca2572e08e">00168</a>         <a class="code" href="packetheader_8h.html#f754720bc60e6c844bda5b322163dfa9">uint64_t</a> <a class="code" href="unionargs.html#6bcc037ed07aa7a15579dfca2572e08e">arr_argui</a>[2];  <span class="comment">// anyway the union is of size 128 due to tf_args</span>
<a name="l00169"></a><a class="code" href="unionargs.html#ab27454e3069a742b70596eb51d611e5">00169</a>         <a class="code" href="structtf__arg.html">tf_args_t</a> <a class="code" href="unionargs.html#ab27454e3069a742b70596eb51d611e5">tf_args</a>;
<a name="l00170"></a><a class="code" href="unionargs.html#8bd4056061b4ee4b93da760d4cc3ef84">00170</a>         dim3 <a class="code" href="unionargs.html#8bd4056061b4ee4b93da760d4cc3ef84">arg_dim</a>;      <span class="comment">// This does increase the size of the union but what to do</span>
<a name="l00171"></a><a class="code" href="unionargs.html#1609532c9a7a9e8b350b253d6438bec2">00171</a>         cudaStream_t <a class="code" href="unionargs.html#1609532c9a7a9e8b350b253d6438bec2">arg_str</a>;
<a name="l00172"></a><a class="code" href="unionargs.html#41e64389e76ea9d57c71ae9ec70c2d20">00172</a>         <a class="code" href="structreg__func__args__t.html">reg_func_args_t</a> *<a class="code" href="unionargs.html#41e64389e76ea9d57c71ae9ec70c2d20">reg_func_args</a>;
<a name="l00173"></a><a class="code" href="unionargs.html#29d6777a23daf123496328ddedfba4a1">00173</a>         <a class="code" href="structreg__var__args__t.html">reg_var_args_t</a> *<a class="code" href="unionargs.html#29d6777a23daf123496328ddedfba4a1">reg_vars</a>;
<a name="l00174"></a><a class="code" href="unionargs.html#99a48c299c94bcf6c82ae9a2e6d26922">00174</a>         <a class="code" href="structreg__tex__args__t.html">reg_tex_args_t</a> *<a class="code" href="unionargs.html#99a48c299c94bcf6c82ae9a2e6d26922">reg_texs</a>;
<a name="l00175"></a>00175 } <a class="code" href="unionargs.html">args_t</a>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="comment">// Possible return types in a response or some extra information on the way to</span>
<a name="l00178"></a>00178 <span class="comment">// the backend</span>
<a name="l00179"></a><a class="code" href="unionret__extra.html">00179</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="unionret__extra.html">ret_extra</a> {
<a name="l00180"></a><a class="code" href="unionret__extra.html#3476157e0de7f6a02aa1122e12b6cea5">00180</a>         <span class="keywordtype">int</span> <a class="code" href="unionret__extra.html#3476157e0de7f6a02aa1122e12b6cea5">num_args</a>;       <span class="comment">// tells backend the number of args in case of map_pages_in_backend</span>
<a name="l00181"></a><a class="code" href="unionret__extra.html#914e21d5256eddaebbed166d437a8e7d">00181</a>         <span class="keywordtype">int</span> <a class="code" href="unionret__extra.html#914e21d5256eddaebbed166d437a8e7d">bit_idx</a>;        <span class="comment">// Pass idx into bitmap for mmap cases (HACK)</span>
<a name="l00182"></a><a class="code" href="unionret__extra.html#977f55860e7d8480de38923527e6312d">00182</a>         <a class="code" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a> <a class="code" href="unionret__extra.html#977f55860e7d8480de38923527e6312d">data_unit</a>; <span class="comment">// tells how to interpret size</span>
<a name="l00183"></a><a class="code" href="unionret__extra.html#397370e21d72405ed5c03b10137ebb08">00183</a>         cudaError_t <a class="code" href="unionret__extra.html#397370e21d72405ed5c03b10137ebb08">err</a>;    <span class="comment">// most common return type</span>
<a name="l00184"></a><a class="code" href="unionret__extra.html#8561d4e7051361615aa6280c5a8d6588">00184</a>         cudaError_t *<a class="code" href="unionret__extra.html#8561d4e7051361615aa6280c5a8d6588">errp</a>;  <span class="comment">// return type for cudaMalloc so far</span>
<a name="l00185"></a><a class="code" href="unionret__extra.html#408277e72a18298dc397e6f62d696087">00185</a>         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="unionret__extra.html#408277e72a18298dc397e6f62d696087">charp</a>;  <span class="comment">// seen this one somewhere</span>
<a name="l00186"></a><a class="code" href="unionret__extra.html#818ffc413218b58463e14fb67eae64ca">00186</a>         <span class="keywordtype">void</span> **<a class="code" href="unionret__extra.html#818ffc413218b58463e14fb67eae64ca">handle</a>;      <span class="comment">// Used to return fatCubinHandle</span>
<a name="l00187"></a>00187 } <a class="code" href="unionret__extra.html">ret_extra_t</a>;
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="structcuda__packet.html">00189</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structcuda__packet.html">cuda_packet</a> {
<a name="l00190"></a><a class="code" href="structcuda__packet.html#6e85f8e764b7a23d5adb53e93c8bcdc0">00190</a>         <a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">uint16_t</a> <a class="code" href="structcuda__packet.html#6e85f8e764b7a23d5adb53e93c8bcdc0">method_id</a>;     <span class="comment">// to identify which method</span>
<a name="l00191"></a><a class="code" href="structcuda__packet.html#fe1a5debd532d6f8b8ac12a75549aa72">00191</a>         <a class="code" href="packetheader_8h.html#99379dcb550a2add43c23d0613450acf">uint16_t</a> <a class="code" href="structcuda__packet.html#fe1a5debd532d6f8b8ac12a75549aa72">req_id</a>;        <span class="comment">// to identify which request is the response for in case async</span>
<a name="l00192"></a><a class="code" href="structcuda__packet.html#aaf8bfac0e1dc9fa7e7fe00048a68c1d">00192</a>         <a class="code" href="packetheader_8h.html#df4aa8556c0392d549d390e1036a2ed9">tid_t</a> <a class="code" href="structcuda__packet.html#aaf8bfac0e1dc9fa7e7fe00048a68c1d">thr_id</a>;           <span class="comment">// thread sending request</span>
<a name="l00193"></a><a class="code" href="structcuda__packet.html#b30f3f55c45d640305d656d68fb00a56">00193</a>         <a class="code" href="packetheader_8h.html#3ebf7c4fcbf17b618a01df30a79859d3">uint8_t</a> <a class="code" href="structcuda__packet.html#b30f3f55c45d640305d656d68fb00a56">flags</a>;          <span class="comment">// if ever needed to indicate more data for the same call</span>
<a name="l00194"></a><a class="code" href="structcuda__packet.html#3d753ec075dfa65ff943a5cc2e649f64">00194</a>         <a class="code" href="unionargs.html">args_t</a> <a class="code" href="unionargs.html">args</a>[<a class="code" href="packetheader_8h.html#d73df97f461eeacacf44ee136256a68b">MAX_ARGS</a>];  <span class="comment">// arguments to be copied on ring</span>
<a name="l00195"></a><a class="code" href="structcuda__packet.html#5dfa9f7dd01a3e82e9e6b46b5da86c26">00195</a>         <a class="code" href="unionret__extra.html">ret_extra_t</a> <a class="code" href="structcuda__packet.html#5dfa9f7dd01a3e82e9e6b46b5da86c26">ret_ex_val</a>; <span class="comment">// return value from call filled in response packet</span>
<a name="l00196"></a>00196                                                         <span class="comment">// when coming from backend or extra information from</span>
<a name="l00197"></a>00197                                                         <span class="comment">// frontend</span>
<a name="l00198"></a>00198 } <a class="code" href="structcuda__packet.html">cuda_packet_t</a>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="preprocessor">#endif </span><span class="comment">/* PACKETHEADER_H_ */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu May 5 16:22:26 2011 for kidron-utils-rce by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
