<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>kidron-utils-rce: remote/connection.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>remote/connection.c File Reference</h1><code>#include &quot;<a class="el" href="connection_8h-source.html">connection.h</a>&quot;</code><br>
<code>#include &lt;netdb.h&gt;</code><br>
<code>#include &quot;<a class="el" href="debug_8h-source.html">debug.h</a>&quot;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &quot;<a class="el" href="libciutils_8h-source.html">libciutils.h</a>&quot;</code><br>
<code>#include &lt;assert.h&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#b14445c0d33b94c4bca0c7f64193be08">conn_sendCudaPktHdr</a> (<a class="el" href="structconnection.html">conn_t</a> *pConn, const <a class="el" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a> num_cuda_pkts, const int buf_size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#1a46aea80b77f0bbcddd1048f429584a">conn_malloc</a> (const char *const pFuncName, const char *const pExtraMsg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#5cfca91c8554dd04be58a2bbfaff3db3">conn_connect</a> (<a class="el" href="structconnection.html">conn_t</a> *conn, const char *remote_host)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#1fcbf1ecccf8c73f4f15473af0e9be35">conn_close</a> (<a class="el" href="structconnection.html">conn_t</a> *conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#0d768f9a26de1b674ea9b418135e78be">conn_localbind</a> (<a class="el" href="structconnection.html">conn_t</a> *listen_conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#8cfe60284cda0b81e6ee803154a07d06">conn_accept</a> (<a class="el" href="structconnection.html">conn_t</a> *listen_conn, <a class="el" href="structconnection.html">conn_t</a> *new_conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#a3bedeaa3159e3218bcf82f82a57c2f2">put</a> (<a class="el" href="structconnection.html">conn_t</a> *conn, void *msg, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="connection_8c.html#f984fab07da3bd6a4a22492170b3c4d9">get</a> (<a class="el" href="structconnection.html">conn_t</a> *conn, void *msg, int len)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8cfe60284cda0b81e6ee803154a07d06"></a><!-- doxytag: member="connection.c::conn_accept" ref="8cfe60284cda0b81e6ee803154a07d06" args="(conn_t *listen_conn, conn_t *new_conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int conn_accept           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>listen_conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>new_conn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Accept a new connection (for the listening thread) <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>listen_conn</em>&nbsp;</td><td>listening connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>new_conn</em>&nbsp;</td><td>receiving connection </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>execution status </dd></dl>

</div>
</div><p>
<a class="anchor" name="1fcbf1ecccf8c73f4f15473af0e9be35"></a><!-- doxytag: member="connection.c::conn_close" ref="1fcbf1ecccf8c73f4f15473af0e9be35" args="(conn_t *conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int conn_close           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close a connection <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>conn</em>&nbsp;</td><td>connection to be closed </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 ok, -1 problems </dd></dl>

</div>
</div><p>
<a class="anchor" name="5cfca91c8554dd04be58a2bbfaff3db3"></a><!-- doxytag: member="connection.c::conn_connect" ref="5cfca91c8554dd04be58a2bbfaff3db3" args="(conn_t *conn, const char *remote_host)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int conn_connect           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>remote_host</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Establish a connection (for local domUs to go remote) <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>conn</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>remote_host</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 everything ok -1 problems </dd></dl>

</div>
</div><p>
<a class="anchor" name="0d768f9a26de1b674ea9b418135e78be"></a><!-- doxytag: member="connection.c::conn_localbind" ref="0d768f9a26de1b674ea9b418135e78be" args="(conn_t *listen_conn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int conn_localbind           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>listen_conn</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set up a connection to be bound to the localhost. After calling this function, accept() can be called on the contained socket.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>listen_conn</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>execution status (0 - 0k, -1 problems) </dd></dl>

</div>
</div><p>
<a class="anchor" name="1a46aea80b77f0bbcddd1048f429584a"></a><!-- doxytag: member="connection.c::conn_malloc" ref="1a46aea80b77f0bbcddd1048f429584a" args="(const char *const pFuncName, const char *const pExtraMsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structconnection.html">conn_t</a>* conn_malloc           </td>
          <td>(</td>
          <td class="paramtype">const char *const &nbsp;</td>
          <td class="paramname"> <em>pFuncName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const &nbsp;</td>
          <td class="paramname"> <em>pExtraMsg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocates the memory for the connection; <dl compact><dt><b>Returns:</b></dt><dd>myconn The allocated place for myconn NULL </dd></dl>

</div>
</div><p>
<a class="anchor" name="b14445c0d33b94c4bca0c7f64193be08"></a><!-- doxytag: member="connection.c::conn_sendCudaPktHdr" ref="b14445c0d33b94c4bca0c7f64193be08" args="(conn_t *pConn, const uint32_t num_cuda_pkts, const int buf_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int conn_sendCudaPktHdr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pConn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="packetheader_8h.html#6dffdaa3be697bee6b7286a8120d3638">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>num_cuda_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>buf_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sends the cuda packet header over the connection pConn <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pConn</em>&nbsp;</td><td>The connection we use to send the packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>num_cuda_pkts</em>&nbsp;</td><td>say how many cuda packets you promise to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sends</em>&nbsp;</td><td>the size of the buffer (response or request) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>OK if everything went ok ERROR there were problems with sending the packet of network </dd></dl>

</div>
</div><p>
<a class="anchor" name="f984fab07da3bd6a4a22492170b3c4d9"></a><!-- doxytag: member="connection.c::get" ref="f984fab07da3bd6a4a22492170b3c4d9" args="(conn_t *conn, void *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get (receive) data. <dl compact><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>Put and Send should probably accept remote packets, not all this fine-grained detail. Maybe call it recv_strm.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>conn</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>strange return values </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>-EINVAL 0 if sent finished 1 normal exit from the function </dd></dl>

</div>
</div><p>
<a class="anchor" name="a3bedeaa3159e3218bcf82f82a57c2f2"></a><!-- doxytag: member="connection.c::put" ref="a3bedeaa3159e3218bcf82f82a57c2f2" args="(conn_t *conn, void *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int put           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structconnection.html">conn_t</a> *&nbsp;</td>
          <td class="paramname"> <em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 5 16:22:26 2011 for kidron-utils-rce by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
